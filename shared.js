var _0x560a5e=_0x1d05;(function(_0x149910,_0x2f9137){var _0x231aa2=_0x1d05,_0x4b2d73=_0x149910();while(!![]){try{var _0x34e1f8=parseInt(_0x231aa2(0x14a))/0x1*(-parseInt(_0x231aa2(0x123))/0x2)+-parseInt(_0x231aa2(0x125))/0x3+-parseInt(_0x231aa2(0x14c))/0x4+parseInt(_0x231aa2(0x130))/0x5+-parseInt(_0x231aa2(0xfa))/0x6+-parseInt(_0x231aa2(0x10c))/0x7+parseInt(_0x231aa2(0x13b))/0x8;if(_0x34e1f8===_0x2f9137)break;else _0x4b2d73['push'](_0x4b2d73['shift']());}catch(_0x919297){_0x4b2d73['push'](_0x4b2d73['shift']());}}}(_0x37b4,0x2e7d6));var E;typeof exports===_0x560a5e(0x144)?E={}:E=exports;types={'entity':{'player':0x0,'player2':0x1,'player3':0x2,'player4':0x3,'bomb':0x4,'wave':0x5,'block':0x6,'box':0x7,'loot':0x8,'player_downed':0x9,'stone':0xa},'dir':{'up':0x1,'right':0x2,'down':0x3,'left':0x4},'key':{'up':0x49,'right':0x4c,'down':0x4b,'left':0x4a,'space':0x20},'sound':{'ship':0x0,'put_bomb':0x1,'explode':0x2,'pickup_loot':0x3,'resident':0x4,'x':0x5},'loot':{'speed':0x1,'power':0x2,'bombs':0x3},'opcode':{'move':0xe,'new_player':0x11,'new_map':0x12}},URL='http://aesct.github.io',FRAME_RATE=0x28,SERVER_FRAME=0xa,INFINITE=Number[_0x560a5e(0x121)],MAX_ID=0x1ffff,MAX_QUEUE_SIZE=0x3ff,MAX_ROW=0xd,MAX_COL=0xf,UNIT=0x40,WIDTH=UNIT*MAX_COL,HEIGHT=UNIT*MAX_ROW,MAX_PLAYERS=0x4,numPlayers=0x0,maps=[[[0x0,0x0,0x1,0x1,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x1,0x0,0x0],[0x0,0x2,0x1,0x0,0x1,0x1,0x1,0x0,0x1,0x1,0x1,0x0,0x1,0x2,0x0],[0x1,0x1,0x0,0x1,0x0,0x1,0x0,0x1,0x0,0x1,0x0,0x1,0x0,0x1,0x1],[0x1,0x0,0x1,0x0,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x1,0x0,0x1],[0x1,0x0,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x1],[0x1,0x0,0x1,0x0,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x1,0x0,0x1],[0x1,0x0,0x1,0x1,0x1,0x1,0x2,0x2,0x2,0x1,0x1,0x1,0x1,0x0,0x1],[0x1,0x1,0x0,0x1,0x0,0x1,0x1,0x1,0x1,0x1,0x0,0x1,0x0,0x1,0x1],[0x1,0x1,0x1,0x0,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x1,0x1,0x1],[0x1,0x1,0x1,0x1,0x0,0x1,0x0,0x1,0x0,0x1,0x0,0x1,0x1,0x1,0x1],[0x1,0x1,0x0,0x1,0x1,0x0,0x1,0x1,0x1,0x0,0x1,0x1,0x0,0x1,0x1],[0x1,0x2,0x0,0x1,0x1,0x1,0x0,0x0,0x0,0x1,0x1,0x1,0x0,0x2,0x1],[0x0,0x0,0x0,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x0,0x0]],[[0x0,0x0,0x1,0x1,0x1,0x1,0x0,0x0,0x0,0x1,0x1,0x1,0x1,0x0,0x0],[0x0,0x2,0x1,0x2,0x1,0x2,0x0,0x2,0x0,0x2,0x1,0x2,0x1,0x2,0x0],[0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1],[0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1],[0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1],[0x0,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x0],[0x0,0x0,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x0],[0x0,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x0],[0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1],[0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x2,0x1],[0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1],[0x0,0x2,0x1,0x2,0x1,0x2,0x0,0x2,0x0,0x2,0x1,0x2,0x1,0x2,0x0],[0x0,0x0,0x1,0x1,0x1,0x1,0x0,0x0,0x0,0x1,0x1,0x1,0x1,0x0,0x0]],[[0x0,0x1,0x1,0x1,0x1,0x0,0x0,0x0,0x1,0x0,0x2,0x1,0x2,0x0,0x2],[0x0,0x2,0x1,0x2,0x1,0x2,0x1,0x0,0x0,0x2,0x1,0x1,0x0,0x0,0x0],[0x0,0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x1,0x0,0x2,0x1,0x2,0x1,0x2],[0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x0,0x0,0x2,0x1,0x1,0x1,0x1,0x1],[0x1,0x1,0x1,0x1,0x1,0x0,0x0,0x0,0x1,0x0,0x2,0x1,0x2,0x1,0x2],[0x1,0x2,0x1,0x2,0x1,0x2,0x1,0x1,0x0,0x0,0x1,0x1,0x1,0x1,0x1],[0x2,0x0,0x2,0x0,0x2,0x0,0x0,0x0,0x1,0x0,0x2,0x0,0x2,0x0,0x2],[0x1,0x1,0x1,0x1,0x1,0x0,0x1,0x0,0x0,0x2,0x1,0x2,0x1,0x2,0x1],[0x2,0x1,0x2,0x1,0x2,0x0,0x0,0x1,0x1,0x0,0x1,0x1,0x1,0x1,0x1],[0x1,0x1,0x1,0x1,0x1,0x2,0x1,0x0,0x0,0x2,0x1,0x2,0x1,0x2,0x1],[0x2,0x0,0x2,0x1,0x2,0x0,0x0,0x0,0x1,0x0,0x1,0x1,0x1,0x1,0x0],[0x0,0x0,0x1,0x1,0x1,0x2,0x1,0x1,0x0,0x2,0x1,0x2,0x1,0x2,0x0],[0x2,0x0,0x2,0x1,0x2,0x0,0x0,0x0,0x1,0x0,0x1,0x1,0x1,0x0,0x0]]];function bind(_0x2df40f,_0x440b23){return _0x2df40f>=0x0&&_0x2df40f<MAX_ROW&&_0x440b23>=0x0&&_0x440b23<MAX_COL;}function getRowID(_0x5081e0){var _0x3959ec=_0x560a5e;return Math[_0x3959ec(0xfc)](_0x5081e0/UNIT);}function getColID(_0x3e7d46){var _0x1de39f=_0x560a5e;return Math[_0x1de39f(0xfc)](_0x3e7d46/UNIT);}function remove(_0x593ca9,_0x32a5a1,_0x4c025c){var _0xc450fa=_0x560a5e;typeof _0x4c025c!=_0xc450fa(0x144)&&(_0x4c025c[_0x593ca9[_0x32a5a1]['rowId']][_0x593ca9[_0x32a5a1][_0xc450fa(0x11e)]]=0x0),delete _0x593ca9[_0x32a5a1],releaseID(_0x32a5a1);}function clientRemove(_0x4e3bca,_0x328d4f,_0x141593){var _0x1be705=_0x560a5e;typeof _0x141593!=_0x1be705(0x144)&&(_0x141593[_0x4e3bca[_0x328d4f][_0x1be705(0x146)][_0x1be705(0x13a)]][_0x4e3bca[_0x328d4f][_0x1be705(0x146)][_0x1be705(0x11e)]]=0x0),delete _0x4e3bca[_0x328d4f];}class Queue{constructor(_0x5f7960){var _0x5cf44f=_0x560a5e;this[_0x5cf44f(0x100)]=_0x5f7960+0x1,this['data']=[this[_0x5cf44f(0x100)]],this[_0x5cf44f(0x131)]=0x0,this[_0x5cf44f(0x147)]=0x0;}[_0x560a5e(0x114)](){var _0xb4a029=_0x560a5e;return this[_0xb4a029(0x131)]==this[_0xb4a029(0x147)];}[_0x560a5e(0x13d)](){var _0x286d08=_0x560a5e;return(this['queueR']+0x1)%this['size']==this[_0x286d08(0x131)];}[_0x560a5e(0xf9)](){var _0xd0958c=_0x560a5e,_0xc15905=this['data'][this[_0xd0958c(0x131)]];return this[_0xd0958c(0x131)]=(this[_0xd0958c(0x131)]+0x1)%this['size'],_0xc15905;}[_0x560a5e(0xf7)](_0x55fe33){var _0x120dea=_0x560a5e;if(this['full']())return;this[_0x120dea(0x122)][this[_0x120dea(0x147)]]=_0x55fe33,this[_0x120dea(0x147)]=(this[_0x120dea(0x147)]+0x1)%this[_0x120dea(0x100)];}[_0x560a5e(0x106)](){var _0x2333eb=_0x560a5e;return this['data'][this[_0x2333eb(0x131)]];}[_0x560a5e(0x10a)](){var _0x4e1e9f=_0x560a5e;return this[_0x4e1e9f(0x122)][(this['queueL']+0x1)%this[_0x4e1e9f(0x100)]];}[_0x560a5e(0x129)](){var _0x19d5e1=_0x560a5e;return this[_0x19d5e1(0x131)]<=this['queueR']?this[_0x19d5e1(0x147)]-this[_0x19d5e1(0x131)]:this[_0x19d5e1(0x100)]-this[_0x19d5e1(0x131)]+this[_0x19d5e1(0x147)];}[_0x560a5e(0x126)](_0x46feb2){var _0x4ef33b=_0x560a5e,_0x3e72e3=this[_0x4ef33b(0x131)];while(_0x3e72e3!=this[_0x4ef33b(0x147)]){_0x46feb2(this[_0x4ef33b(0x122)][_0x3e72e3]),_0x3e72e3=(_0x3e72e3+0x1)%this['size'];}}}class EntityState{constructor(_0x118c67,_0x46ddbd,_0x11ec40,_0x472f38){var _0x26b521=_0x560a5e;this['id']=_0x118c67,this['x']=_0x46ddbd,this['y']=_0x11ec40,this[_0x26b521(0x100)]=_0x472f38,this[_0x26b521(0x13a)]=getRowID(_0x11ec40),this[_0x26b521(0x11e)]=getColID(_0x46ddbd),this[_0x26b521(0x140)]=0x0;}['update'](_0x536b2c){}}class BoxState extends EntityState{constructor(_0x593dd8,_0x5f219a,_0x29d1a4){var _0x1d2467=_0x560a5e;super(_0x593dd8,_0x5f219a,_0x29d1a4),this[_0x1d2467(0x145)]=0x1,_0x5f219a!=-0x1&&(boxMatrix[this['rowId']][this[_0x1d2467(0x11e)]]=this['id']);}['destroyBox'](){!(this['id']in toDestroyBoxes)&&(toDestroyBoxes[this['id']]=this);}}boxes={},toDestroyBoxes={};function _0x37b4(){var _0x486b48=['pushCtr','123084WCyJbL','iterate','currentBombNumber','maxSpeed','length','doChain','justPut','playerNum','revivePlayer','maxPower','disconnectPlayer','1669055aHkimn','queueL','applyInput','opcode','bombs','score','key','round','splice','min','rowId','7176648BmabwP','loot','full','power','owner','dir','destroyBox','chainBomb','tryChain','undefined','type','state','queueR','volatile','ttl','628hObXzF','len','1178236fYzjhV','chain','push','maxMaxBombNumber','shift','1916784LFIDoL','emit','floor','ackSeqId','serverUpdate','move','size','putTime','down','doBomb','pickupLoot','putBomb','peek','downedFrame','previousPushCtr','blocked','peekSecond','prepID','2104473EVOPWX','disconnect','keys','new_player','spawn','delta','speed','spawnPlayer','empty','update','where','right','downPlayer','downed','new_map','justPick','left','stackedSpeed','colId','msgQueue','maxBombNumber','MAX_VALUE','data','270dnXYhX'];_0x37b4=function(){return _0x486b48;};return _0x37b4();}var boxMatrix,stoneMatrix;class PlayerState extends EntityState{constructor(_0x51b483,_0xce3cd5,_0x2ed285,_0x3b795e,_0x2b05f5){var _0x505d2d=_0x560a5e;super(_0x51b483,_0xce3cd5,_0x2ed285,_0x3b795e),this[_0x505d2d(0x119)]=![],this['downedFrame']=0x0,this[_0x505d2d(0x11d)]=0x0,this[_0x505d2d(0x112)]=0xf,this[_0x505d2d(0x128)]=0x1e,this[_0x505d2d(0x13e)]=0x1,this['maxPower']=0x8,this['currentBombNumber']=0x0,this[_0x505d2d(0x120)]=0x1,this['maxMaxBombNumber']=0x8,this[_0x505d2d(0xfd)]=0x0,this[_0x505d2d(0x135)]=0x0,this['msgQueue']=new Queue(FRAME_RATE),this[_0x505d2d(0x12c)]=_0x2b05f5,this[_0x505d2d(0x12b)]=![],this[_0x505d2d(0x11b)]=![];}[_0x560a5e(0x118)](){var _0x5096c6=_0x560a5e;!this[_0x5096c6(0x119)]&&(this['downed']=!![],this[_0x5096c6(0x107)]=0x0,this['stackedSpeed']=this[_0x5096c6(0x112)],this[_0x5096c6(0x112)]=0x3);}[_0x560a5e(0x12d)](){var _0x8d8cae=_0x560a5e;this['downed']&&(this[_0x8d8cae(0x119)]=![],this[_0x8d8cae(0x112)]=this[_0x8d8cae(0x11d)]);}[_0x560a5e(0x104)](_0x7b82cb){var _0x53795a=_0x560a5e;this[_0x53795a(0x11b)]=!![];switch(_0x7b82cb){case types[_0x53795a(0x13c)][_0x53795a(0x112)]:this[_0x53795a(0x112)]=Math['min'](this[_0x53795a(0x128)],this[_0x53795a(0x112)]+0x2);break;case types[_0x53795a(0x13c)]['power']:this['power']=Math[_0x53795a(0x139)](this[_0x53795a(0x12e)],this[_0x53795a(0x13e)]+0x1);break;case types[_0x53795a(0x13c)][_0x53795a(0x134)]:this[_0x53795a(0x120)]=Math[_0x53795a(0x139)](this[_0x53795a(0xf8)],this['maxBombNumber']+0x1);break;}}[_0x560a5e(0xff)](_0x57f585,_0x31d054,_0x3d74bd){var _0x347012=_0x560a5e;this['dir']=_0x31d054;var _0xa31b21=this[_0x347012(0x112)]*_0x57f585/0x64,_0x490f7e=this[_0x347012(0x100)]>>0x1,_0x56c6fa=[[],[this['x'],this['y']-_0x490f7e-_0xa31b21],[this['x']+_0x490f7e+_0xa31b21,this['y']],[this['x'],this['y']+_0x490f7e+_0xa31b21],[this['x']-_0x490f7e-_0xa31b21,this['y']]],_0x3c67b3=Math[_0x347012(0x137)](_0x56c6fa[_0x31d054][0x0]),_0x243f61=Math[_0x347012(0x137)](_0x56c6fa[_0x31d054][0x1]),_0x43e182=getColID(_0x3c67b3),_0x2e8783=getRowID(_0x243f61),_0x5d120a=[[],[0x0,_0x490f7e],[-_0x490f7e,0x0],[0x0,-_0x490f7e],[_0x490f7e,0x0]];_0x3c67b3+=_0x5d120a[_0x31d054][0x0],_0x243f61+=_0x5d120a[_0x31d054][0x1];if(!bind(_0x2e8783,_0x43e182))return;if((_0x2e8783!=this[_0x347012(0x13a)]||_0x43e182!=this[_0x347012(0x11e)])&&(bombMatrix[_0x2e8783][_0x43e182]||boxMatrix[_0x2e8783][_0x43e182]||stoneMatrix[_0x2e8783][_0x43e182])){if(!_0x3d74bd)return;var _0x142e3d=bombMatrix[_0x2e8783][_0x43e182];if(_0x142e3d){var _0x231e57=bombs[_0x142e3d];_0x231e57[_0x347012(0x108)]=_0x231e57[_0x347012(0x124)]++,_0x231e57[_0x347012(0x124)]>=SERVER_FRAME&&_0x231e57[_0x347012(0xf7)](_0x31d054);}return;}this['x']=_0x3c67b3,this['y']=_0x243f61,this[_0x347012(0x13a)]=getRowID(this['y']),this['colId']=getColID(this['x']);if(!_0x3d74bd)return;waveMatrix[this['rowId']][this['colId']]&&this[_0x347012(0x118)]();for(var _0x3b03da in playerMatrix[this[_0x347012(0x13a)]][this['colId']]){if(_0x3b03da==this['id'])continue;_0x3b03da in players&&players[_0x3b03da][_0x347012(0x119)]&&(players[_0x3b03da]['revivePlayer'](),this[_0x347012(0x135)]++);}var _0x1b4c0f=lootMatrix[this[_0x347012(0x13a)]][this[_0x347012(0x11e)]];_0x1b4c0f&&(this[_0x347012(0x104)](loots[_0x1b4c0f]['type']),remove(loots,_0x1b4c0f,lootMatrix));}[_0x560a5e(0x105)](){var _0x297c7a=_0x560a5e;if(this[_0x297c7a(0x119)])return;if(bombMatrix[this[_0x297c7a(0x13a)]][this[_0x297c7a(0x11e)]]||boxMatrix[this[_0x297c7a(0x13a)]][this['colId']]||stoneMatrix[this[_0x297c7a(0x13a)]][this['colId']])return;if(this[_0x297c7a(0x127)]>=this['maxBombNumber'])return;this[_0x297c7a(0x127)]++,this[_0x297c7a(0x12b)]=!![];var _0x3b3792=getID();bombs[_0x3b3792]=new BombState(_0x3b3792,this['x'],this['y'],this[_0x297c7a(0x13e)],this['id'],UNIT),bombs[_0x3b3792][_0x297c7a(0x12a)]();}[_0x560a5e(0x132)](_0x1aadfd,_0x44d8df){var _0x3aa732=_0x560a5e;this['ackSeqId']=_0x1aadfd['seqId'];var _0x278a72=_0x1aadfd[_0x3aa732(0x136)]>>0x1,_0x3b4c01=_0x1aadfd[_0x3aa732(0x111)];switch(_0x278a72){case types[_0x3aa732(0x136)]['up']:this[_0x3aa732(0xff)](_0x3b4c01,types['dir']['up'],_0x44d8df);break;case types[_0x3aa732(0x136)][_0x3aa732(0x117)]:this['move'](_0x3b4c01,types['dir'][_0x3aa732(0x117)],_0x44d8df);break;case types[_0x3aa732(0x136)][_0x3aa732(0x102)]:this['move'](_0x3b4c01,types[_0x3aa732(0x140)][_0x3aa732(0x102)],_0x44d8df);break;case types[_0x3aa732(0x136)][_0x3aa732(0x11c)]:this[_0x3aa732(0xff)](_0x3b4c01,types[_0x3aa732(0x140)]['left'],_0x44d8df);break;}}}players={};var playerMatrix;class BombState extends EntityState{constructor(_0x5cb28d,_0xd45732,_0x37f548,_0x4f3653,_0x33e8c2,_0x282121){var _0x120714=_0x560a5e;super(_0x5cb28d,_0xd45732,_0x37f548),this['x']=this['colId']*UNIT+(UNIT>>0x1),this['y']=this['rowId']*UNIT+(UNIT>>0x1),this[_0x120714(0x14d)]=[],this[_0x120714(0x13e)]=_0x4f3653,this['putTime']=0x0,this[_0x120714(0x149)]=SERVER_FRAME*0x3,this[_0x120714(0x13f)]=_0x33e8c2,_0xd45732!=-0x1&&(bombMatrix[this[_0x120714(0x13a)]][this[_0x120714(0x11e)]]=_0x5cb28d),this[_0x120714(0x108)]=0x0,this[_0x120714(0x124)]=0x0,this[_0x120714(0x140)]=0x0,this[_0x120714(0x112)]=UNIT+UNIT>>0x1,this['size']=_0x282121;}[_0x560a5e(0x109)](_0x3c15e9,_0x172407){return bind(_0x3c15e9,_0x172407)&&(boxMatrix[_0x3c15e9][_0x172407]||stoneMatrix[_0x3c15e9][_0x172407]);}[_0x560a5e(0xf7)](_0x419e13){var _0xb2209d=_0x560a5e,_0x237132=[[],[-0x1,0x0],[0x0,0x1],[0x1,0x0],[0x0,-0x1]],_0x1757b7=this[_0xb2209d(0x13a)]+_0x237132[_0x419e13][0x0],_0x4bcda3=this['colId']+_0x237132[_0x419e13][0x1];if(!bind(_0x1757b7,_0x4bcda3)||bombMatrix[_0x1757b7][_0x4bcda3]||this[_0xb2209d(0x109)](_0x1757b7,_0x4bcda3))return;this[_0xb2209d(0x140)]=_0x419e13;for(var _0x59b3ba in this[_0xb2209d(0x14d)]){var _0x45f4f7=bombs[this['chain'][_0x59b3ba]]['chain'];for(var _0x10765a in _0x45f4f7){if(_0x45f4f7[_0x10765a]==this['id']){_0x45f4f7[_0xb2209d(0x138)](_0x10765a,0x1);break;}}}this[_0xb2209d(0x14d)]=[],bombMatrix[this[_0xb2209d(0x13a)]][this[_0xb2209d(0x11e)]]=0x0;}['doBomb'](){var _0x350141=_0x560a5e;remove(bombs,this['id'],bombMatrix);if(this[_0x350141(0x13f)]in players){var _0x34e383=players[this[_0x350141(0x13f)]];_0x34e383['currentBombNumber']--,_0x34e383[_0x350141(0x127)]<0x0&&(_0x34e383[_0x350141(0x127)]=0x0);}var _0x522246=[[0x0,this[_0x350141(0x13a)]+0x1,this[_0x350141(0x11e)],this[_0x350141(0x13a)]+this[_0x350141(0x13e)],this[_0x350141(0x11e)]+this[_0x350141(0x13e)],0x1,0x0,types['dir'][_0x350141(0x102)]],[0x1,this[_0x350141(0x13a)]-0x1,this[_0x350141(0x11e)],this[_0x350141(0x13a)]-this[_0x350141(0x13e)],this[_0x350141(0x11e)]-this[_0x350141(0x13e)],-0x1,0x0,types[_0x350141(0x140)]['up']],[0x0,this[_0x350141(0x13a)],this[_0x350141(0x11e)]+0x1,this[_0x350141(0x13a)]+this[_0x350141(0x13e)],this[_0x350141(0x11e)]+this[_0x350141(0x13e)],0x0,0x1,types[_0x350141(0x140)][_0x350141(0x117)]],[0x1,this[_0x350141(0x13a)],this[_0x350141(0x11e)]-0x1,this[_0x350141(0x13a)]-this[_0x350141(0x13e)],this['colId']-this[_0x350141(0x13e)],0x0,-0x1,types[_0x350141(0x140)]['left']]];for(var _0x41a257=0x0;_0x41a257<_0x522246['length'];_0x41a257++){var _0x358bdf=_0x522246[_0x41a257],_0x74b218=0x0;for(var _0x27baac=_0x358bdf[0x1],_0x2d9333=_0x358bdf[0x2];_0x358bdf[0x0]?_0x27baac>=_0x358bdf[0x3]&&_0x2d9333>=_0x358bdf[0x4]:_0x27baac<=_0x358bdf[0x3]&&_0x2d9333<=_0x358bdf[0x4];){if(!bind(_0x27baac,_0x2d9333)||stoneMatrix[_0x27baac][_0x2d9333])break;if(boxMatrix[_0x27baac][_0x2d9333]){var _0x483e29=boxMatrix[_0x27baac][_0x2d9333];boxes[_0x483e29][_0x350141(0x141)]();break;}var _0x543400=lootMatrix[_0x27baac][_0x2d9333];_0x543400&&remove(loots,_0x543400,lootMatrix);var _0xbb19e3=Object[_0x350141(0x10e)](playerMatrix[_0x27baac][_0x2d9333]);if(_0xbb19e3[_0x350141(0x129)])for(var _0x483e29 in _0xbb19e3){players[_0xbb19e3[_0x483e29]][_0x350141(0x118)]();}waveMatrix[_0x27baac][_0x2d9333]=0x1,_0x27baac+=_0x358bdf[0x5],_0x2d9333+=_0x358bdf[0x6],_0x74b218++;}if(_0x74b218){var _0x483e29=getID();waves[_0x483e29]=new WaveState(_0x483e29,_0x358bdf[0x1],_0x358bdf[0x2],_0x358bdf[0x7],_0x74b218),wavesToBroadcast[_0x350141(0xf7)](_0x483e29);}}}[_0x560a5e(0x142)](_0x448f95){var _0x510583=_0x560a5e;bombsVisited[_0x448f95['id']]=0x1,_0x448f95[_0x510583(0x103)]();for(var _0xfa2c6d in _0x448f95[_0x510583(0x14d)]){if(bombsVisited[_0x448f95[_0x510583(0x14d)][_0xfa2c6d]])continue;bombsVisited[_0x448f95[_0x510583(0x14d)][_0xfa2c6d]]=0x1,this['chainBomb'](bombs[_0x448f95['chain'][_0xfa2c6d]]);}}[_0x560a5e(0x143)](_0x5956e4,_0x2bcb70){var _0x45bd66=_0x560a5e,_0x138588=bombMatrix[_0x5956e4][_0x2bcb70];if(_0x138588&&bind(_0x5956e4,_0x2bcb70))return bombs[this['id']]['chain'][_0x45bd66(0xf7)](_0x138588),bombs[_0x138588][_0x45bd66(0x14d)][_0x45bd66(0xf7)](this['id']),!![];return![];}[_0x560a5e(0x12a)](){var _0x9f8566=_0x560a5e,_0x111937=[[0x0,this[_0x9f8566(0x13a)]+0x1,this[_0x9f8566(0x11e)],this['rowId']+this[_0x9f8566(0x13e)],this['colId']+this[_0x9f8566(0x13e)],0x1,0x0],[0x1,this[_0x9f8566(0x13a)]-0x1,this[_0x9f8566(0x11e)],this[_0x9f8566(0x13a)]-this[_0x9f8566(0x13e)],this['colId']-this[_0x9f8566(0x13e)],-0x1,0x0],[0x0,this[_0x9f8566(0x13a)],this[_0x9f8566(0x11e)]+0x1,this[_0x9f8566(0x13a)]+this[_0x9f8566(0x13e)],this[_0x9f8566(0x11e)]+this[_0x9f8566(0x13e)],0x0,0x1],[0x1,this['rowId'],this['colId']-0x1,this['rowId']-this[_0x9f8566(0x13e)],this[_0x9f8566(0x11e)]-this[_0x9f8566(0x13e)],0x0,-0x1]];for(var _0x1fdf10=0x0;_0x1fdf10<_0x111937[_0x9f8566(0x129)];_0x1fdf10++){var _0x1bc02c=_0x111937[_0x1fdf10];for(var _0x5810bf=_0x1bc02c[0x1],_0x19db2c=_0x1bc02c[0x2];_0x1bc02c[0x0]?_0x5810bf>=_0x1bc02c[0x3]&&_0x19db2c>=_0x1bc02c[0x4]:_0x5810bf<=_0x1bc02c[0x3]&&_0x19db2c<=_0x1bc02c[0x4];){if(!bind(_0x5810bf,_0x19db2c)||this['blocked'](_0x5810bf,_0x19db2c))break;if(this[_0x9f8566(0x143)](_0x5810bf,_0x19db2c))break;_0x5810bf+=_0x1bc02c[0x5],_0x19db2c+=_0x1bc02c[0x6];}}}[_0x560a5e(0x115)](_0x5b0bea){var _0x2e695c=_0x560a5e;!this[_0x2e695c(0x140)]&&this[_0x2e695c(0x101)]++==this[_0x2e695c(0x149)]&&(bombsVisited={},this[_0x2e695c(0x142)](this));this[_0x2e695c(0x124)]==this[_0x2e695c(0x108)]&&(this[_0x2e695c(0x124)]=0x0);if(!this[_0x2e695c(0x140)])return;var _0x4e1822=this[_0x2e695c(0x112)]*_0x5b0bea/0x64,_0x4ec95d=this['size']>>0x1,_0x52d63f=[[],[this['x'],this['y']-_0x4e1822],[this['x']+_0x4e1822,this['y']],[this['x'],this['y']+_0x4e1822],[this['x']-_0x4e1822,this['y']]],_0x527d2b=Math['round'](_0x52d63f[this['dir']][0x0]),_0x521a83=Math[_0x2e695c(0x137)](_0x52d63f[this[_0x2e695c(0x140)]][0x1]),_0x421597=getColID(_0x527d2b),_0x59bab5=getRowID(_0x521a83);if(!bind(_0x59bab5,_0x421597)||(_0x59bab5!=this['rowId']||_0x421597!=this[_0x2e695c(0x11e)])&&(bombMatrix[_0x59bab5][_0x421597]||boxMatrix[_0x59bab5][_0x421597]||stoneMatrix[_0x59bab5][_0x421597])){this['doChain'](),this['putTime']=0x0,this[_0x2e695c(0x140)]=0x0,bombMatrix[this[_0x2e695c(0x13a)]][this['colId']]=this['id'];return;}this[_0x2e695c(0x13a)]=_0x59bab5,this[_0x2e695c(0x11e)]=_0x421597,this['x']=_0x527d2b,this['y']=_0x521a83;}}bombs={},bombsVisited={};var bombMatrix;class WaveState extends EntityState{constructor(_0x106523,_0x5d6bd6,_0x593e66,_0x9d0fd4,_0x1d570d){var _0x29aaee=_0x560a5e;super(_0x106523,_0x593e66*UNIT,_0x5d6bd6*UNIT),this[_0x29aaee(0x140)]=_0x9d0fd4,this[_0x29aaee(0x145)]=_0x9d0fd4,this[_0x29aaee(0x13a)]=_0x5d6bd6,this[_0x29aaee(0x11e)]=_0x593e66,this[_0x29aaee(0x14b)]=_0x1d570d,this['createTime']=0x0,this['ttl']=SERVER_FRAME>>0x1;}[_0x560a5e(0x115)](_0x2acc83){var _0x2b1694=_0x560a5e;if(this['createTime']++==this[_0x2b1694(0x149)]){remove(waves,this['id']);var _0x5613ab=[[0x1,this['rowId']-this['len'],this[_0x2b1694(0x11e)]-this[_0x2b1694(0x14b)],-0x1,0x0],[0x0,this[_0x2b1694(0x13a)]+this['len'],this['colId']+this[_0x2b1694(0x14b)],0x0,0x1],[0x0,this[_0x2b1694(0x13a)]+this[_0x2b1694(0x14b)],this[_0x2b1694(0x11e)]+this[_0x2b1694(0x14b)],0x1,0x0],[0x1,this[_0x2b1694(0x13a)]-this[_0x2b1694(0x14b)],this[_0x2b1694(0x11e)]-this['len'],0x0,-0x1]],_0x48bfcc=_0x5613ab[this['dir']-0x1];for(var _0xc5ea54=this[_0x2b1694(0x13a)],_0x4eb45d=this[_0x2b1694(0x11e)];_0x48bfcc[0x0]?_0xc5ea54>_0x48bfcc[0x1]&&_0x4eb45d>_0x48bfcc[0x2]:_0xc5ea54<_0x48bfcc[0x1]&&_0x4eb45d<_0x48bfcc[0x2];){waveMatrix[_0xc5ea54][_0x4eb45d]=0x0,_0xc5ea54+=_0x48bfcc[0x3],_0x4eb45d+=_0x48bfcc[0x4];}return;}}}waves={},wavesToBroadcast=[],wavesClient={};var waveMatrix;class LootState extends EntityState{constructor(_0xb848e6,_0x2a9ac6,_0x5ac13c){var _0x2c383e=_0x560a5e;super(_0xb848e6,_0x2a9ac6,_0x5ac13c);var _0x26abae=[types[_0x2c383e(0x13c)][_0x2c383e(0x112)],types[_0x2c383e(0x13c)][_0x2c383e(0x13e)],types[_0x2c383e(0x13c)][_0x2c383e(0x134)]];this['type']=_0x26abae[getRandomInt(0x3)];}}loots={};var lootMatrix;msgQueue=new Queue(MAX_QUEUE_SIZE),clients={};function recvMessage(_0x51ff99,_0x296361){var _0x22f091=_0x560a5e;if(!(_0x51ff99 in players))return;players[_0x51ff99]['msgQueue'][_0x22f091(0xf7)](_0x296361);}idQueue=new Queue(MAX_ID);function getRandomInt(_0x58aad3){var _0x41dba8=_0x560a5e;return Math['floor'](Math['random']()*Math[_0x41dba8(0xfc)](_0x58aad3));}function _0x1d05(_0x3e2127,_0x4c95f2){var _0x37b4c5=_0x37b4();return _0x1d05=function(_0x1d0587,_0x200229){_0x1d0587=_0x1d0587-0xf7;var _0x2388c0=_0x37b4c5[_0x1d0587];return _0x2388c0;},_0x1d05(_0x3e2127,_0x4c95f2);}function prepID(_0x402af1){var _0x48ad5e=_0x560a5e;for(var _0x1e5689=0x1;_0x1e5689<=_0x402af1;_0x1e5689++){idQueue[_0x48ad5e(0xf7)](_0x1e5689);}}function getID(){var _0xad8de9=_0x560a5e;return idQueue[_0xad8de9(0xf9)]();}function releaseID(_0x459868){var _0x43678e=_0x560a5e;idQueue[_0x43678e(0xf7)](_0x459868);}function matrixToIntArray(_0x417119,_0x50f61c){var _0x208fd3=_0x560a5e,_0x1d5ac5=[];for(var _0x53bb26=0x0;_0x53bb26<MAX_ROW;_0x53bb26++){var _0x13d7c2=0x0,_0x24a8f5=0x1;for(var _0x73d69f=0x0;_0x73d69f<MAX_COL;_0x73d69f++){_0x13d7c2+=_0x24a8f5*(_0x417119[_0x53bb26][_0x73d69f]?_0x50f61c[_0x417119[_0x53bb26][_0x73d69f]][_0x208fd3(0x145)]:0x0),_0x24a8f5*=0x4;}_0x1d5ac5[_0x208fd3(0xf7)](_0x13d7c2);}return _0x1d5ac5;}function intArrayToMatrix(_0x5ea999){var _0x55dc81={};for(var _0x9b1c9e=0x0;_0x9b1c9e<MAX_ROW;_0x9b1c9e++){_0x55dc81[_0x9b1c9e]={};var _0x3d89da=0x0;while(_0x5ea999[_0x9b1c9e]){_0x55dc81[_0x9b1c9e][_0x3d89da++]=_0x5ea999[_0x9b1c9e]%0x4,_0x5ea999[_0x9b1c9e]=Math['floor'](_0x5ea999[_0x9b1c9e]/0x4);}while(_0x3d89da<MAX_COL){_0x55dc81[_0x9b1c9e][_0x3d89da++]=0x0;}}return _0x55dc81;}function clearMatrix(_0x1d8c3){var _0x4d5021=new Array(MAX_ROW);for(var _0x4919e6=0x0;_0x4919e6<MAX_ROW;_0x4919e6++){_0x4d5021[_0x4919e6]=new Array(MAX_COL);for(var _0x55ef8c=0x0;_0x55ef8c<MAX_COL;_0x55ef8c++){typeof _0x1d8c3!='undefined'?_0x4d5021[_0x4919e6][_0x55ef8c]=_0x1d8c3:_0x4d5021[_0x4919e6][_0x55ef8c]=0x0;}}return _0x4d5021;}function init(){boxMatrix=clearMatrix(),stoneMatrix=clearMatrix(),bombMatrix=clearMatrix(),lootMatrix=clearMatrix(),waveMatrix=clearMatrix(),playerMatrix=clearMatrix({});for(var _0x524111 in loots){remove(loots,_0x524111);}for(var _0x524111 in boxes){remove(boxes,_0x524111);}var _0x36f79d=maps[currentMap];for(var _0x524111=0x0;_0x524111<MAX_ROW;_0x524111++){for(var _0x1dc49e=0x0;_0x1dc49e<MAX_COL;_0x1dc49e++){if(_0x36f79d[_0x524111][_0x1dc49e]==0x1){var _0xa00c07=getID();boxes[_0xa00c07]=new BoxState(_0xa00c07,_0x1dc49e*UNIT,_0x524111*UNIT),boxMatrix[_0x524111][_0x1dc49e]=_0xa00c07;}else _0x36f79d[_0x524111][_0x1dc49e]==0x2?stoneMatrix[_0x524111][_0x1dc49e]=0x1:boxMatrix[_0x524111][_0x1dc49e]=0x0;}}}function handleClientMessage(_0xb855db,_0xc71afb){var _0x31111f=_0x560a5e;switch(_0xb855db['o']){case types[_0x31111f(0x133)][_0x31111f(0xff)]:_0xb855db['i']['delta']=0x3e8/FRAME_RATE;_0xb855db['i']['key']&0x1&&_0xc71afb[_0x31111f(0x105)]();_0xc71afb['applyInput'](_0xb855db['i'],!![]);break;}}function playerStateToInt(_0x18e370){var _0x1c7da4=_0x560a5e,_0x39337d=_0x18e370[_0x1c7da4(0x140)];_0x39337d=_0x39337d<<0x1|_0x18e370[_0x1c7da4(0x119)],_0x39337d=_0x39337d<<0x4|_0x18e370['score'],_0x39337d=_0x39337d<<0x2|_0x18e370[_0x1c7da4(0x12c)],_0x39337d=_0x39337d<<0x1|_0x18e370[_0x1c7da4(0x12b)],_0x39337d=_0x39337d<<0x1|_0x18e370[_0x1c7da4(0x11b)];var _0x6234bf=_0x18e370['x'];return _0x6234bf=_0x6234bf<<0xa|_0x18e370['y'],_0x6234bf=_0x6234bf<<0x5|_0x18e370['speed'],[_0x39337d,_0x6234bf];}function intToPlayerState(_0x4318e6){var _0x44c6cd=_0x560a5e,_0x503e42=_0x4318e6[0x0],_0x267ad6=_0x4318e6[0x1],_0x532208={};return _0x532208[_0x44c6cd(0x112)]=_0x267ad6&0x1f,_0x267ad6>>=0x5,_0x532208['y']=_0x267ad6&0x3ff,_0x267ad6>>=0xa,_0x532208['x']=_0x267ad6,_0x532208[_0x44c6cd(0x11b)]=_0x503e42&0x1,_0x503e42>>=0x1,_0x532208['justPut']=_0x503e42&0x1,_0x503e42>>=0x1,_0x532208[_0x44c6cd(0x12c)]=_0x503e42&0x3,_0x503e42>>=0x2,_0x532208[_0x44c6cd(0x135)]=_0x503e42&0xf,_0x503e42>>=0x4,_0x532208[_0x44c6cd(0x119)]=_0x503e42&0x1,_0x503e42>>=0x1,_0x532208[_0x44c6cd(0x140)]=_0x503e42,_0x532208;}function waveStateToInt(_0x25270b){var _0x193aee=_0x560a5e,_0x25cba9=_0x25270b[_0x193aee(0x13a)];return _0x25cba9=_0x25cba9<<0x4|_0x25270b[_0x193aee(0x11e)],_0x25cba9=_0x25cba9<<0x3|_0x25270b[_0x193aee(0x140)],_0x25cba9=_0x25cba9<<0x4|_0x25270b[_0x193aee(0x14b)],_0x25cba9;}function intToWaveState(_0x37078c){var _0x12f681=_0x560a5e,_0x4cefa9={};return _0x4cefa9[_0x12f681(0x14b)]=_0x37078c&0xf,_0x37078c>>=0x4,_0x4cefa9['dir']=_0x37078c&0x7,_0x37078c>>=0x3,_0x4cefa9[_0x12f681(0x11e)]=_0x37078c&0xf,_0x37078c>>=0x4,_0x4cefa9[_0x12f681(0x13a)]=_0x37078c,_0x4cefa9;}function broadcastState(){var _0x204cf4=_0x560a5e,_0x56f45a=[];for(var _0x31e9e2 in players){var _0x5685da=players[_0x31e9e2];_0x56f45a['push']({'id':_0x31e9e2,'aid':_0x5685da[_0x204cf4(0xfd)],'s':playerStateToInt(_0x5685da)}),_0x5685da[_0x204cf4(0x12b)]=![],_0x5685da[_0x204cf4(0x11b)]=![];}var _0x1546b6=[];for(var _0x31e9e2 in wavesToBroadcast){var _0x3a1b02=waves[wavesToBroadcast[_0x31e9e2]];_0x1546b6['push']({'s':waveStateToInt(_0x3a1b02)});}wavesToBroadcast=[];var _0x337847=[];for(var _0x31e9e2 in bombs){_0x337847[_0x204cf4(0xf7)]({'id':_0x31e9e2,'s':bombs[_0x31e9e2]['x']<<0xa|bombs[_0x31e9e2]['y']});}for(var _0x31e9e2 in players){clients[_0x31e9e2][_0x204cf4(0x148)][_0x204cf4(0xfb)]('opcode',{'o':types[_0x204cf4(0x133)][_0x204cf4(0xff)],'p':_0x56f45a,'w':_0x1546b6,'b':_0x337847,'l':matrixToIntArray(lootMatrix,loots),'bo':matrixToIntArray(boxMatrix,boxes)});}}var currentMap=0x1;function restartGame(){var _0x51d428=_0x560a5e;currentMap=(currentMap+0x1)%maps['length'],init(),numPlayers=0x0;for(var _0x36d21d in playerSpawns){playerSpawns[_0x36d21d][_0x51d428(0x110)]=!![];}spawnedPlayers={};for(var _0x5a3351 in players){doSpawn(_0x5a3351);}for(var _0x1f055f in players){clients[_0x1f055f][_0x51d428(0xfb)](_0x51d428(0x133),{'o':types[_0x51d428(0x133)][_0x51d428(0x11a)],'m':currentMap});}}function serverUpdate(_0x2c6326,_0x494204){var _0x574d85=_0x560a5e;for(var _0x1768a8 in players){var _0x528e53=players[_0x1768a8],_0x1ca346=_0x528e53[_0x574d85(0x11f)],_0x37a5cd=0x0;while(_0x37a5cd<FRAME_RATE/SERVER_FRAME&&!_0x1ca346[_0x574d85(0x114)]()){_0x37a5cd++,handleClientMessage(_0x1ca346['shift'](),_0x528e53);}}var _0x36ff1f=![];for(var _0x1768a8 in players){var _0x528e53=players[_0x1768a8];_0x36ff1f|=_0x528e53[_0x574d85(0x135)]>=0x5,_0x528e53[_0x574d85(0x119)]&&(_0x528e53[_0x574d85(0x107)]++,_0x528e53[_0x574d85(0x107)]==SERVER_FRAME*0x5&&_0x528e53['revivePlayer']());}_0x36ff1f&&restartGame();for(var _0x2872c8 in waves){waves[_0x2872c8]['update'](_0x2c6326);}for(var _0x1768a8 in toDestroyBoxes){var _0x26ae23=getRandomInt(0x64);if(_0x26ae23<=0x32){var _0x2cf762=getID(),_0xfd63b3=boxes[_0x1768a8]['x'],_0x47fe13=boxes[_0x1768a8]['y'],_0x49e1c1=boxes[_0x1768a8][_0x574d85(0x13a)],_0x5eff89=boxes[_0x1768a8]['colId'];loots[_0x2cf762]=new LootState(_0x2cf762,_0xfd63b3,_0x47fe13),lootMatrix[_0x49e1c1][_0x5eff89]=_0x2cf762;}remove(boxes,_0x1768a8,boxMatrix);}toDestroyBoxes={},broadcastState();}function update(_0x127832){var _0x34f3f8=_0x560a5e;for(var _0x50106c=0x0;_0x50106c<MAX_ROW;_0x50106c++){for(var _0x493b45=0x0;_0x493b45<MAX_COL;_0x493b45++){playerMatrix[_0x50106c][_0x493b45]={};}}for(var _0x3e14cc in players){var _0x4d431d=players[_0x3e14cc],_0x3407af=typeof _0x4d431d['state']==_0x34f3f8(0x144)?_0x4d431d[_0x34f3f8(0x13a)]:_0x4d431d[_0x34f3f8(0x146)][_0x34f3f8(0x13a)],_0x10ef20=typeof _0x4d431d[_0x34f3f8(0x146)]==_0x34f3f8(0x144)?_0x4d431d[_0x34f3f8(0x11e)]:_0x4d431d[_0x34f3f8(0x146)][_0x34f3f8(0x11e)];playerMatrix[_0x3407af][_0x10ef20][_0x3e14cc]=0x1;}for(var _0x50106c in bombs){bombs[_0x50106c]['update'](_0x127832);}}playerSpawns=[{'spawn':!![],'where':[UNIT>>0x1,UNIT*(MAX_ROW-0x1)+(UNIT>>0x1)]},{'spawn':!![],'where':[UNIT>>0x1,UNIT>>0x1]},{'spawn':!![],'where':[UNIT*(MAX_COL-0x1)+(UNIT>>0x1),UNIT>>0x1]},{'spawn':!![],'where':[UNIT*(MAX_COL-0x1)+(UNIT>>0x1),UNIT*(MAX_ROW-0x1)+(UNIT>>0x1)]}],spawnedPlayers={};function doSpawn(_0xc24119){var _0x5b790b=_0x560a5e;for(var _0x34bdc9=0x0;_0x34bdc9<playerSpawns[_0x5b790b(0x129)];_0x34bdc9++){var _0xb231f9=playerSpawns[_0x34bdc9];if(!_0xb231f9[_0x5b790b(0x110)])continue;var _0x3a1a40=_0xb231f9[_0x5b790b(0x116)][0x0],_0x1da125=_0xb231f9[_0x5b790b(0x116)][0x1];players[_0xc24119]=new PlayerState(_0xc24119,_0x3a1a40,_0x1da125,UNIT,_0x34bdc9),spawnedPlayers[_0xc24119]=_0x34bdc9,_0xb231f9[_0x5b790b(0x110)]=![],numPlayers++,clients[_0xc24119][_0x5b790b(0xfb)](_0x5b790b(0x133),{'o':types['opcode'][_0x5b790b(0x10f)],'id':_0xc24119,'m':currentMap});break;}}function spawnPlayer(_0x427c56,_0x22bdef){var _0x2101e3=_0x560a5e;!(_0x427c56 in clients)&&numPlayers<MAX_PLAYERS?(clients[_0x427c56]=_0x22bdef,doSpawn(_0x427c56)):_0x22bdef[_0x2101e3(0x10d)]();}function disconnectPlayer(_0x42bba2){var _0x27525c=_0x560a5e;_0x42bba2 in clients&&(delete clients[_0x42bba2],delete players[_0x42bba2],numPlayers--,playerSpawns[spawnedPlayers[_0x42bba2]][_0x27525c(0x110)]=!![],delete spawnedPlayers[_0x42bba2]);}E['init']=init,E[_0x560a5e(0x115)]=update,E[_0x560a5e(0x113)]=spawnPlayer,E['recvMessage']=recvMessage,E[_0x560a5e(0xfe)]=serverUpdate,E[_0x560a5e(0x10b)]=prepID,E[_0x560a5e(0x12f)]=disconnectPlayer;
